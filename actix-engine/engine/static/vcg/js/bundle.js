(()=>{"use strict";var e={455:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(249);function r(e,t,n){const o=n.options;for(let n=0;n<o.length;n++)o[n].textContent===t&&"none"!==t?o[n].disabled=!0:o[n].textContent===e&&(o[n].disabled=!1)}function s(e){const t=e.value;return/^[a-zA-Z]+$/.test(t)?""===t.replace(/\s/g,"")?(document.getElementById("error-msg").textContent="can't be empty",!1):(document.getElementById("error-msg").textContent="",!0):(document.getElementById("error-msg").textContent="Only alphabetic characters are allowed.",!1)}t.is_null_good=function(e){return e===o.NULL_GOOD},t.has_null_good_selected=function(e){return parseInt(e.options[e.options.selectedIndex].dataset.good_id)===o.NULL_GOOD.id},t.toggleOption=r,t.clearRow=function(e){for(let t=0;t<e.length;t++){e[t].style.backgroundColor=o.goods[0].color,document.getElementById("bidInput"+t).value="";const n=e[t].querySelector("select");n.selectedIndex=o.NULL_GOOD_INDEX,n.dispatchEvent(new Event("change"))}},t.createRow=function(e,t,n){const s=document.createElement("div");s.className="row";const a=document.createElement("input");a.type="text",a.id="bidInput"+e,a.addEventListener("input",(function(e){const t=e.target;t.value=t.value.replace(/\D/g,"").slice(0,30)}));const l=document.createElement("select");l.setAttribute("id","select"+e),l.dataset.index=e.toString();for(const e of o.goods){const t=document.createElement("option");t.value=e.color,t.textContent=e.name,t.dataset.good_id=e.id.toString(),l.appendChild(t)}l.addEventListener("change",(function(){s.style.backgroundColor=this.value;const e=l.options[l.options.selectedIndex].textContent,o=n[parseInt(l.dataset.index||"0")]||"none";n[parseInt(l.dataset.index||"+")]=e;const a=t.getElementsByClassName("row");for(let t=0;t<a.length;t++)r(o,e,a[t].querySelector("select"))})),s.appendChild(a),s.appendChild(l),t.appendChild(s)},t.validateInput=s,t.colorCodeToInteger=function(e){return e=e.replace("#",""),parseInt(e,16)},t.integerToColorCode=function(e){return"#"+e.toString(16).padStart(6,"0")},t.getPushBackUrl=function(){const e=window.location.href;return"/"===e.slice(-1)?e+"submit_bids":e+"/submit_bids"},window.validateInput=s},249:(e,t)=>{function n(e,t,n){return{id:e,name:t,color:n}}Object.defineProperty(t,"__esModule",{value:!0}),t.createGoodObj=n,t.createPlayerObj=function(e,t){return{id:e,name:t}},t.NULL_GOOD=n(6,"none","#FFFFFF"),t.goods=[n(0,"Firaks","#808B96"),n(1,"Ivits","#FF0000"),n(2,"Terran","#0000FF"),n(3,"Xenon","#FFFF00"),n(4,"Geoden","#F39c12"),n(5,"Itars","#FFFFFF"),t.NULL_GOOD],t.NULL_GOOD_INDEX=t.goods.length-1}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,n),s.exports}(()=>{const e=n(455),t=n(249);document.addEventListener("DOMContentLoaded",(function(){let n=0;const o=document.getElementById("selectN"),r=document.getElementById("rowContainer");let s,a={id:Math.floor(9007199254740990*Math.random())+1,player_nr:parseInt(o.value),pls:[],goods:t.goods,bid_pairings:[]};o.addEventListener("change",(function(){let l;if(l=!(n>0)||confirm("Are you sure you want to change the number of players? Bids will be reset"),l){this.dataset.previousValue=this.value;const l=parseInt(this.value);s=Array(l).fill("none"),r.innerHTML="";for(let t=0;t<l;t++)(0,e.createRow)(t,r,s);n=0,a={id:Math.floor(9007199254740990*Math.random())+1,player_nr:parseInt(o.value),pls:[],goods:t.goods,bid_pairings:[]},(0,e.clearRow)(r.getElementsByClassName("row")),document.getElementById("name").value=""}else this.value=this.dataset.previousValue||"default-value"})),document.getElementById("submitBids").onclick=function(){0===n&&(a.player_nr=parseInt(o.value));const s=document.getElementById("name");if((0,e.validateInput)(s)){document.getElementById("submit-error-msg").textContent="",a.pls.push((0,t.createPlayerObj)(n,s.value));const l=r.getElementsByClassName("row");for(let t=0;t<parseInt(o.value);t++){const o=l[t].querySelector("select");if(!(0,e.has_null_good_selected)(o)){const e=parseInt(o.options[o.selectedIndex].dataset.good_id);console.log("putting in. good id is "+e);const r=parseInt(document.getElementById("bidInput"+t).value);a.bid_pairings.push([n,e,r])}}n+=1,console.log("players submitted are "+n+" content is : "+JSON.stringify(a)),n===parseInt(o.value)?(console.log((0,e.getPushBackUrl)()),fetch((0,e.getPushBackUrl)(),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then((e=>e.text())).then((e=>{console.log("RECIEVED RESULT, NOW PUTTING IT IN"),document.body.innerHTML=e})).catch((e=>{console.error("Error:",e)}))):((0,e.clearRow)(r.getElementsByClassName("row")),document.getElementById("name").value="")}else document.getElementById("submit-error-msg").textContent="name is invalid"},o.dispatchEvent(new Event("change"))}))})()})();