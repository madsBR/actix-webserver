(()=>{"use strict";var e={33:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPushBackUrl=t.integerToColorCode=t.colorCodeToInteger=t.validateInput=t.createRow=t.clearRow=t.toggleOption=t.has_null_good_selected=t.is_null_good=void 0;const o=n(757);function r(e,t,n){const o=n.options;for(let n=0;n<o.length;n++)o[n].textContent===t&&"none"!==t?o[n].disabled=!0:o[n].textContent===e&&(o[n].disabled=!1)}function a(e){const t=e.value;return/^[a-zA-Z]+$/.test(t)?""===t.replace(/\s/g,"")?(document.getElementById("error-msg").textContent="can't be empty",!1):(document.getElementById("error-msg").textContent="",!0):(document.getElementById("error-msg").textContent="Only alphabetic characters are allowed.",!1)}t.is_null_good=function(e){return e===o.NULL_GOOD},t.has_null_good_selected=function(e){return parseInt(e.options[e.options.selectedIndex].dataset.good_id)===o.NULL_GOOD.id},t.toggleOption=r,t.clearRow=function(e){for(let t=0;t<e.length;t++){e[t].style.backgroundColor=o.goods[0].color.str,document.getElementById("bidInput"+t).value="";const n=e[t].querySelector("select");n.selectedIndex=o.NULL_GOOD_INDEX,n.dispatchEvent(new Event("change"))}},t.createRow=function(e,t,n){const a=document.createElement("div");a.className="row";const l=document.createElement("input");l.type="text",l.id="bidInput"+e,l.addEventListener("input",(function(e){const t=e.target;t.value=t.value.replace(/\D/g,"").slice(0,30)}));const d=document.createElement("select");d.setAttribute("id","select"+e),d.dataset.index=e.toString();for(const e of o.goods){const t=document.createElement("option");t.value=e.color.str,t.textContent=e.name,t.dataset.good_id=e.id.toString(),d.appendChild(t)}d.addEventListener("change",(function(){a.style.backgroundColor=this.value;const e=d.options[d.options.selectedIndex].textContent,o=n[parseInt(d.dataset.index||"0")]||"none";n[parseInt(d.dataset.index||"+")]=e;const l=t.getElementsByClassName("row");for(let t=0;t<l.length;t++)r(o,e,l[t].querySelector("select"))})),a.appendChild(l),a.appendChild(d),t.appendChild(a)},t.validateInput=a,t.colorCodeToInteger=function(e){return e=e.replace("#",""),parseInt(e,16)},t.integerToColorCode=function(e){return"#"+e.toString(16).padStart(6,"0")},t.getPushBackUrl=function(){const e=window.location.href;return"/"===e.slice(-1)?e+"submit_bids":e+"/submit_bids"},window.validateInput=a},757:(e,t)=>{function n(e,t,n){return{id:e,name:t,color:{str:n}}}Object.defineProperty(t,"__esModule",{value:!0}),t.NULL_GOOD_INDEX=t.goods=t.NULL_GOOD=t.createPlayerExt=t.createGoodObj=void 0,t.createGoodObj=n,t.createPlayerExt=function(e,t){return{id:e,name:t}},t.NULL_GOOD=n(6,"none","#FFFFFF"),t.goods=[n(0,"Firaks","#808B96"),n(1,"Ivits","#FF0000"),n(2,"Terran","#0000FF"),n(3,"Xenon","#FFFF00"),n(4,"Geoden","#F39c12"),n(5,"Itars","#FFFFFF"),t.NULL_GOOD],t.NULL_GOOD_INDEX=t.goods.length-1},42:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.dummy_data=t.createResultRows=void 0;const n=JSON.parse('[\n    {\n      "pl": {\n        "id": 1,\n        "name": "John Doe"\n      },\n      "good_color_price": {\n        "good": {\n          "id": 100,\n          "name": "Toy",\n          "color": {\n            "str": "#00AABB"\n          }\n        },\n        "price": {\n          "val": 50\n        }\n      }\n    },\n    {\n      "pl": {\n        "id": 2,\n        "name": "Jane Smith"\n      },\n      "good_color_price": {\n        "good": {\n          "id": 200,\n          "name": "Book",\n          "color": {\n            "str": "#AAFF11"\n          }\n        },\n        "price": {\n          "val": 30\n        }\n      }\n    }\n  ]');function o(e,t,n){if(n>=t.length)return;const r=function(e){const t=document.createElement("tr"),n=document.createElement("td");n.textContent=e.playerName,t.appendChild(n);const o=document.createElement("td");o.textContent=e.goodName,t.appendChild(o);const r=document.createElement("td");return r.textContent=e.price.toString(),t.appendChild(r),t.style.backgroundColor=e.goodColor,setTimeout((()=>{t.classList.add("fade-in")}),50),t}(function(e){const{pl:t,good_color_price:n}=e;return n?function(e,t){return{playerName:e.name,goodName:t.good.name,price:t.price.val,goodColor:t.good.color.str}}(t,n):function(e){return{playerName:e.name,goodName:"none",price:0,goodColor:"gray"}}(t)}(t[n]));e.appendChild(r),setTimeout((()=>{o(e,t,n+1)}),500)}t.dummy_data=n,t.createResultRows=function(e){const t=document.querySelector("#outputPairingTable tbody");null!=t&&o(t,e,0)}}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,n),a.exports}(()=>{const e=n(33),t=n(757),o=n(42);document.addEventListener("DOMContentLoaded",(function(){let n=0;const r=document.getElementById("selectN"),a=document.getElementById("rowContainer");let l,d={id:Math.floor(9007199254740990*Math.random())+1,player_nr:parseInt(r.value),pls:[],goods:t.goods,bid_pairings:[]};r.addEventListener("change",(function(){let o;if(o=!(n>0)||confirm("Are you sure you want to change the number of players? Bids will be reset"),o){this.dataset.previousValue=this.value;const o=parseInt(this.value);l=Array(o).fill("none"),a.innerHTML="";for(let t=0;t<o;t++)(0,e.createRow)(t,a,l);n=0,d={id:Math.floor(9007199254740990*Math.random())+1,player_nr:parseInt(r.value),pls:[],goods:t.goods,bid_pairings:[]},(0,e.clearRow)(a.getElementsByClassName("row")),document.getElementById("name").value=""}else this.value=this.dataset.previousValue||"default-value"})),document.getElementById("submitBids").onclick=function(){0===n&&(d.player_nr=parseInt(r.value));const l=document.getElementById("name");if((0,e.validateInput)(l)){document.getElementById("submit-error-msg").textContent="",d.pls.push((0,t.createPlayerExt)(n,l.value));const s=a.getElementsByClassName("row");for(let t=0;t<parseInt(r.value);t++){const o=s[t].querySelector("select");if(!(0,e.has_null_good_selected)(o)){const e=parseInt(o.options[o.selectedIndex].dataset.good_id);console.log("putting in. good id is "+e);const r=parseInt(document.getElementById("bidInput"+t).value);d.bid_pairings.push([n,e,r])}}n+=1,console.log("players submitted are "+n+" content is : "+JSON.stringify(d)),n===parseInt(r.value)?(console.log((0,e.getPushBackUrl)()),fetch((0,e.getPushBackUrl)(),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}).then((e=>e.text())).then((e=>{console.log("RECIEVED RESULT, NOW PUTTING IT IN"),document.body.innerHTML=e})).then((()=>{console.log("CALLING CREATE RES ROWS"),(0,o.createResultRows)(o.dummy_data)})).catch((e=>{console.error("Error:",e)}))):((0,e.clearRow)(a.getElementsByClassName("row")),document.getElementById("name").value="")}else document.getElementById("submit-error-msg").textContent="name is invalid"},r.dispatchEvent(new Event("change"))}))})()})();